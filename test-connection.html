<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>فحص اتصال Firebase</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            padding: 50px;
        }

        .status {
            padding: 20px;
            margin: 20px auto;
            max-width: 400px;
            border-radius: 10px;
            font-weight: bold;
        }

        .loading {
            background-color: #f0f0f0;
            color: #333;
        }

        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>

<body>
    <h1>فحص اتصال قاعدة البيانات</h1>
    <div id="status" class="status loading">جاري الاتصال...</div>
    <div id="details"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // إعداداتك الحالية
        const firebaseConfig = {
            apiKey: "AIzaSyA-raYlvzPz8T7Mnx8bTWA4O8CyHvp7K_0",
            authDomain: "okcomputer-system.firebaseapp.com",
            projectId: "okcomputer-system",
            storageBucket: "okcomputer-system.firebasestorage.app",
            messagingSenderId: "17748146044",
            appId: "1:17748146044:web:e4a2063ac34c6ee27016f9"
        };

        const statusDiv = document.getElementById('status');
        const detailsDiv = document.getElementById('details');

        try {
            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);

            // محاولة قراءة البيانات (اختبار القراءة)
            getDocs(collection(db, "subscribers")).then(snapshot => {
                statusDiv.className = 'status success';
                statusDiv.innerHTML = '✅ الاتصال ناجح!';
                detailsDiv.innerHTML = `تم العثور على ${snapshot.size} مشترك في قاعدة البيانات.`;
            }).catch(error => {
                console.error(error);
                statusDiv.className = 'status error';
                statusDiv.innerHTML = '❌ فشل الاتصال!';
                detailsDiv.innerHTML = 'تأكد من اتصال الإنترنت أو قواعد الأمان في Firebase.<br>' + error.message;
            });

        } catch (e) {
            statusDiv.className = 'status error';
            statusDiv.innerHTML = '❌ خطأ في التهيئة!';
            detailsDiv.innerHTML = e.message;
        }
    </script>
</body>

</html>
